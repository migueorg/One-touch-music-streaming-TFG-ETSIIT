\chapter{Estado del arte}

El software libre y sus licencias \cite{gplv3} ha permitido llevar a cabo una expansión del
aprendizaje de la informática sin precedentes.

\section{Análisis de las alternativas ya existentes}

Si intentamos solucionar el problema introducido al principio del documento
usando las alternativas existentes actualmente nos vamos a encontrar con
soluciones poco amigables con el usuario, poco eficaces, soluciones de código
privativo y/o demasiado caras.

Usaré el siguiente ejemplo práctico para testear las soluciones actuales y
evaluar el estado del arte: Si llegamos a casa del trabajo, y hemos vuelto
escuchando un podcast en nuestros auriculares inalámbricos mientras andábamos;
al llegar a casa y ponernos a preparar la comida nos gustaría poder seguir
escuchando el podcast por el mismo minuto en el que íbamos pero en los altavoces
de casa. 

\subsection{Solución tradicional}
Para hacer esto, simplemente podríamos conectar el móvil al altavoz mediante el
\emph{jack} de 3.5, sin embargo, los móviles actualmente carecen de dicho puerto
(salvo pocas excepciones). 

\subsection{Solución asistentes virtuales}
Otra opción sería emplear un asistente virtual (\emph{Alexa, Google Assistant,
Siri}) y pedirle que reproduzca el podcast que estábamos escuchando, el problema
de esto es que tendremos que recordar el nombre concreto del podcast, tenemos
que ponernos a hablarle al asistente lo cual rompe la sensación de integración y
continuidad, y a todo esto el asistente tiene que ser capaz de entendernos
correctamente, lo cual no pasa siempre. 

\subsection{Solución \emph{big techs}}
Otra opción más, la cual es compatible con la mayoría de altavoces con
asistentes integrados, sería la de tener el altavoz en red y mandar el podcast
desde el móvil a través de protocolos como \emph{Google Cast, AirPlay o Spotify
Connect}, lo cual es una de las opciones más rápidas y sencillas, pero implica
tener que estar navegando a través de aplicaciones e interfaces hasta llegar a
la opción de enviar contenido. Y en el caso de que tengamos muchos altavoces en
red, tendremos que elegir de entre una lista amplia de dispositivos, al cual
queremos enviar dicho contenido. De nuevo, este último caso, aún siendo el más
factible, rompe mucho con la sensación de integración y continuidad de la que
hablé anteriormente. 

\subsection{Solución \emph{Apple}} Sin embargo, \emph{Apple} sí que tiene una
solución para esto integrada en su ecosistema. Para los usuarios que tengan un
\emph{iPhone} y un \emph{HomePod} \cite{HomePod}, permiten que la reproducción
del \emph{iPhone} continúe en el \emph{HomePod} simplemente con acercar el
\emph{iPhone} al \emph{HomePod}, sin la necesidad de navegar por interfaces ni
seleccionar nada. Todo de forma transparente para el usuario y en cuestión de
segundos. 

Para ello \emph{Apple} emplea un chip propio llamado \emph{Apple U1} (INSERTAR
AQUÍ REFERENCIA AL APPLE U1) en ambos dispositivos (\emph{iPhone} y
\emph{HomePod}), el cual es un chip que dota a los dispositivos de conectividad
a través de \emph{UWB (Ultra Wideband)} (INSERTAR AQUÍ REFERENCIA AL UWB). Este
chip trabaja en una radiofrecuencia entre los 6 y 8GHz, permitiendo así una
comunicación de bajo alcance, muy bajo consumo, pero alto ancho de banda a
partir de los estándares IEEE 802.15.4a y IEEE 802.15.4z, y es usado para
determinar una precisión espacial entre los dispositivos que la porten. Gracias
a esto, tanto \emph{iPhone} como \emph{HomePod} saben que están apuntándose el
uno al otro, para, acto seguido mediante \emph{Apple Handoff} (INSERTAR AQUÍ
REFERENCIA AL Apple Handoff) comunicarse a través de \emph{bluetooth} y
\emph{wifi}, y de esta forma conocer la canción que se estaba reproduciendo en
el \emph{iPhone} y compartir la reproducción a través de \emph{AirPlay}
(INSERTAR AQUÍ REFERENCIA AL AirPlay).

El problema de esto es que se emplean chips específicos de \emph{Apple}, que
además solo vienen incluidos en los \emph{iPhone 11} y superior; por lo que
cualquier \emph{iPhone} inferior al 11, o cualquier dispositivo que no sea Apple
no podrá utilizar esta solución.

\section{Conclusión tras estudiar el mercado}
Tras repasar todas las posibilidades para solventar el problema, vemos que la
que más se asemeja a la solución es la que tiene \emph{Apple}; el problema es
que esa solución es de código privativo, además de muy cerrada, siendo exclusiva
de algunos dispositivos \emph{Apple}. Si queremos disfrutar de la automatización
y transparencia que se aprecia en esta solución no encontramos nada similar ni
cercano. Es por eso que nace la necesidad de crear este proyecto, persiguiendo
un resultado similar al que proporciona \emph{Apple}, pero enfocado en
dispositivos \emph{Android} y sin el uso de chips de \emph{UWB}.\\

\section{Abordaje de la solución}

Uno de las primeros temas que se valoró al comenzar el proyecto fue sobre que
hardware hacerlo funcionar, pues si bien lo ideal sería utiizar altavoces ya
existentes como pueden ser los \emph{Google Home} (INSERTAR AQUÍ REFERENCIA AL
GOOGLE HOME), o los \emph{Amazon Echo} (INSERTAR AQUÍ REFERENCIA AL AMAZON
ECHO); estos no son programables a bajo nivel. Simplemente permiten el
desarrollo de atajos o \emph{skills} para su asistente virtual, por lo que se
alejaba bastante del resultado final existente en los \emph{Apple HomePod}, el
cual se unificaba todo con un simple gesto de proximidad. Es por esto que, con
el fin de simplificar el proceso de desarrollo, se optó por programar sobre
Linux, y que cualquier hardware que pueda correr Linux simule el altavoz tipo
\emph{Apple HomePod}, \emph{Google Home} o \emph{Amazon Echo}; con la diferencia
que en este caso sería completamente de código abierto. Esto a su vez permitiría
que el altavoz se ejecutase sobre cualquier PC con Linux, o sobre cualquier
placa de desarrollo que permita Linux, abriendo un gran abanico de posibilidades
hardware compatibles. 

En la parte de reproducción móvil se trabajará sobre Android por varios motivos;
el primero es que buscamos una filosofía lo más \emph{open source} posible, y
esta se ajusta mejor con la filosofía que tiene \emph{Android} como sistema
operativo móvil. La segunda es que las APIs que permiten el reenvío de audio son
más permisivas en \emph{Android} que en \emph{iOS}, ya que estos últimos están
muy enfocados en la seguridad y privacidad; haciendo que el trabajo con audio
interno del propio sistem operativo sea una tarea mucho más complicada y
compleja. Por último y un poco más a nivel personal, es que dado que los
dispositivos \emph{iOS} ya disponen de una solución exclusiva para ellos, se
busca compensar a los usuarios de \emph{Android} que no han tenido ningún tipo
de posibilidad, brindándoles una solución exclusiva para ellos.

Abordar el problema del empleo del chip \emph{Apple U1} ha sido la más
complicada, pues es el que permite simplificar la tarea con un simple gesto, y
así mismo, es un chip fabricado en exclusiva para el ecosistema de \emph{Apple}.
Si bien es cierto, en \emph{Android} el fabricante \emph{Samsung} recientemente
también ha incorporado un chip de \emph{UWB} en sus dispositivos \emph{Galaxy
Note 20 Ultra, Galaxy S21 Ultra y Galaxy S21+}, intentar abordar el problema con
esta misma tecnología la haría exclusiva de dichos dispositivos \emph{Samsung},
y no solucionaríamos gran cosa. Por no mencionar que también sería necesario el
uso de esa tecnología en el dispositivo que haga de altavoz, complicando aún más
el desarrollo y replicación del mismo.

Valorando las alternativas al \emph{UWB} existentes en (al menos) la gran
mayoría de dispositivos \emph{Android} encontramos el wifi y el bluetooth; pues
a fin de cuentas, al igual que el \emph{UWB}, son tecnologías de
radiocomunicación. El problema es que estas tecnologías tienen un alcance
significativamente mayor al que tiene el \emph{UWB}, y es por esto que no son
ideales para emplearlas en técnicas de posicionamiento a escasos centímetros, lo
cual es lo que se está buscando. El empleo de las mencionadas alternativas
provocaría que se activase en ocasiones en las que realmente no queremos.

Alternativamente existe otra tecnología que históricamente se ha empleado en
usos similares al \emph{UWB}, dado que en el entorno doméstico y comercial, es
conocido como su propio antecesor. Esta tecnología es el \emph{BLE} (INSERTAR
AQUÍ REFERENCIA AL BLE). El BLE \emph{(Bluetooth Low Energy)} es una derivación
del propio \emph{Bluetooth} tradicional, pero enfocado en un bajo consumo de
energía, sacrificando el alcance y velocidad. La cual permite varias clases de
funcionamiento dentro de \emph{BLE}, donde la clase 4 del mismo (el más bajo)
establece un alcance de medio metro. Sin embargo, medio metro me sigue
pareciendo demaisado como para que pueda activarse inintencionadamente; además
de este inconveniente también encontramos con que el descubrimiento
\emph{Bluetooth} suele precisar unos segundos, sin contar con los que
además sean necesarios en la propia comunicación. Haciendo que esta tecnología
quede descartada.

Finalmente en el análisis de las alternativas al \emph{UWB} llegué al estudio
del \emph{NFC} (INSERTAR AQUÍ REFERENCIA AL NFC), el cual si bien no está tan
expandido como el Bluetooth, a día de hoy ya es raro encontrar móviles que
carezcan de esta tecnología. El NFC tiene un alcance que va desde escasos
milímetros hasta no más de 20cm, no requiere tiempo de descubrimiento pues en
cuanto existe el contacto se inicia la comunicación, lo cual lo convierte en una
alternativa viable para emplearla en lugar del ya estudiado \emph{UWB}. El único
inconveniente que encontramos es que será necesario emplear hardware lector de
NFC en el dispositivo Linux que haga de altavoz.


A continuación detallaré que planteamientos se han propuesto para abordar el
problema a solucionar, así como ventajas e inconvenientes de cada uno.

\subsection{Proyecto como aplicación final}

Los primeros pasos para afrontar este proyecto se hicieron proponiendo crear dos
aplicaciones reproductoras de audio, una para Android y otra para Linux. Ambas
tendrían acceso a una misma biblioteca compartida de archivos .mp3 que estaría
en red, por lo que ambos reproductores tendrían conocimiento y acceso a la misma
colección de audio. En dicha biblioteca todos los elementos estaría asociados a
un identificador, por lo que  